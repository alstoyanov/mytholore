<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mytholore - Rotation Puzzle Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      display: flex;
      flex-direction: column;
    }

    .game-header {
      background: rgba(0, 0, 0, 0.8);
      padding: 1rem 0;
      border-bottom: 2px solid #d4af37;
    }

    .game-header img {
      width: 300px;
      height: 112px;
      display: block;
      margin: 0 auto;
    }

    .game-nav {
      text-align: center;
      margin-top: 1rem;
    }

    .game-nav a {
      color: #d4af37;
      text-decoration: none;
      margin: 0 1rem;
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }

    .game-nav a:hover {
      color: #fff;
    }

    .game-main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      gap: 3rem;
    }

    .game-controls-panel {
      display: flex;
      flex-direction: column;
      gap: 2rem;
      min-width: 300px;
    }

    .control-section {
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid #d4af37;
      border-radius: 15px;
      padding: 1.5rem;
    }

    .control-section h3 {
      color: #d4af37;
      margin-top: 0;
      margin-bottom: 1rem;
      text-align: center;
    }

    .image-selector {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .image-option {
      width: 80px;
      height: 80px;
      border: 2px solid #666;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .image-option:hover {
      border-color: #d4af37;
      transform: scale(1.05);
    }

    .image-option.selected {
      border-color: #d4af37;
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
    }

    .game-stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .stat {
      text-align: center;
    }

    .stat-label {
      color: #999;
      font-size: 0.9rem;
    }

    .stat-value {
      color: #d4af37;
      font-size: 1.5rem;
      font-weight: bold;
    }

    .game-button {
      background: #d4af37;
      color: #000;
      border: none;
      padding: 1rem 1.5rem;
      margin: 0.5rem 0;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-weight: bold;
      font-size: 1rem;
      transition: all 0.3s ease;
      width: 100%;
    }

    .game-button:hover {
      background: #b8941f;
      transform: translateY(-2px);
    }

    .help-button {
      background: #4a90e2;
    }

    .help-button:hover {
      background: #357abd;
    }

    .back-button {
      background: #666;
      color: white;
    }

    .back-button:hover {
      background: #555;
    }

    .puzzle-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .puzzle-container {
      border: 3px solid #d4af37;
      border-radius: 15px;
      overflow: hidden;
      background: #000;
      box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
      position: relative;
    }

    .puzzle-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 2px;
      width: 500px;
      height: 500px;
    }

    .puzzle-tile {
      background-size: 500px 500px;
      border: 1px solid #333;
      transition: all 0.3s ease;
      position: relative;
    }

    .rotation-zone {
      position: absolute;
      border: 3px solid transparent;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: transparent;
      background: rgba(212, 175, 55, 0);
    }

    .rotation-zone:hover {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.2);
      color: #d4af37;
    }

    .rotation-zone.rotating {
      border-color: #ff6b35;
      background: rgba(255, 107, 53, 0.3);
      color: #ff6b35;
    }

    /* Rotation zones positioning */
    .zone-top-left {
      top: 0;
      left: 0;
      width: 248px;
      height: 248px;
    }

    .zone-top-right {
      top: 0;
      right: 0;
      width: 248px;
      height: 248px;
    }

    .zone-bottom-left {
      bottom: 0;
      left: 0;
      width: 248px;
      height: 248px;
    }

    .zone-bottom-right {
      bottom: 0;
      right: 0;
      width: 248px;
      height: 248px;
    }

    .zone-center {
      top: 124px;
      left: 124px;
      width: 248px;
      height: 248px;
    }

    .win-message {
      background: rgba(212, 175, 55, 0.95);
      color: #000;
      padding: 2rem;
      border-radius: 15px;
      margin: 1rem 0;
      font-weight: bold;
      font-size: 1.5rem;
      text-align: center;
      display: none;
      box-shadow: 0 0 30px rgba(212, 175, 55, 0.7);
    }

    .help-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .help-content {
      background: rgba(0, 0, 0, 0.9);
      border: 3px solid #d4af37;
      border-radius: 15px;
      padding: 2rem;
      text-align: center;
      max-width: 90%;
      max-height: 90%;
    }

    .help-image {
      max-width: 400px;
      max-height: 400px;
      border: 2px solid #d4af37;
      border-radius: 10px;
      margin-bottom: 1rem;
    }

    .close-help {
      background: #d4af37;
      color: #000;
      border: none;
      padding: 1rem 2rem;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-weight: bold;
      font-size: 1.1rem;
    }

    .instructions {
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid #4a90e2;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      color: #ccc;
      font-size: 0.9rem;
      line-height: 1.4;
    }

    .instructions h4 {
      color: #4a90e2;
      margin-top: 0;
      margin-bottom: 0.5rem;
    }

    @media (max-width: 1200px) {
      .game-main {
        flex-direction: column;
        gap: 2rem;
      }

      .game-controls-panel {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        min-width: auto;
      }

      .control-section {
        flex: 1;
        min-width: 250px;
      }

      .puzzle-grid {
        width: 400px;
        height: 400px;
      }

      .puzzle-tile {
        background-size: 400px 400px;
      }

      .zone-top-left, .zone-top-right, .zone-bottom-left, .zone-bottom-right {
        width: 198px;
        height: 198px;
      }

      .zone-center {
        top: 99px;
        left: 99px;
        width: 198px;
        height: 198px;
      }
    }

    @media (max-width: 768px) {
      .puzzle-grid {
        width: 320px;
        height: 320px;
      }

      .puzzle-tile {
        background-size: 320px 320px;
      }

      .zone-top-left, .zone-top-right, .zone-bottom-left, .zone-bottom-right {
        width: 158px;
        height: 158px;
      }

      .zone-center {
        top: 79px;
        left: 79px;
        width: 158px;
        height: 158px;
      }

      .game-controls-panel {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>
  <div class="game-header">
    <img src="images/mytholore_logo.svg" alt="Mytholore Logo">
    <div class="game-nav">
      <a href="games.html">‚Üê Back to Games</a>
      <a href="index.html">World Map</a>
      <a href="albums.html">Albums</a>
      <a href="about.html">About</a>
    </div>
  </div>

  <div class="game-main">
    <div class="game-controls-panel">
      <div class="control-section">
        <h3>Choose Image</h3>
        <div id="image-selector" class="image-selector">
          <!-- Images will be loaded dynamically -->
        </div>
      </div>

      <div class="control-section">
        <h3>Game Stats</h3>
        <div class="game-stats">
          <div class="stat">
            <div class="stat-label">Rotations</div>
            <div class="stat-value" id="move-count">0</div>
          </div>
          <div class="stat">
            <div class="stat-label">Time</div>
            <div class="stat-value" id="timer">00:00</div>
          </div>
        </div>
        
        <button class="game-button" onclick="shufflePuzzle()">New Game</button>
        <button class="game-button help-button" onclick="showHelp()">Show Complete Image</button>
        <button class="game-button back-button" onclick="window.location.href='games.html'">Back to Games</button>
      </div>

      <div class="control-section">
        <div class="instructions">
          <h4>How to Play:</h4>
          <p>‚Ä¢ Click on the 5 rotation zones to rotate 2x2 sections clockwise</p>
          <p>‚Ä¢ Zones: Top-left, Top-right, Bottom-left, Bottom-right, Center</p>
          <p>‚Ä¢ Hover over zones to see them highlighted</p>
          <p>‚Ä¢ Reconstruct the complete image to win!</p>
        </div>
      </div>
    </div>

    <div class="puzzle-area">
      <div class="win-message" id="win-message">
        üéâ Congratulations! You solved the rotation puzzle! üéâ
      </div>
      
      <div class="puzzle-container">
        <div id="puzzle-grid" class="puzzle-grid"></div>
        
        <!-- Rotation zones -->
        <div class="rotation-zone zone-top-left" onclick="rotateZone('top-left')" title="Rotate Top-Left 2x2">‚Üª</div>
        <div class="rotation-zone zone-top-right" onclick="rotateZone('top-right')" title="Rotate Top-Right 2x2">‚Üª</div>
        <div class="rotation-zone zone-bottom-left" onclick="rotateZone('bottom-left')" title="Rotate Bottom-Left 2x2">‚Üª</div>
        <div class="rotation-zone zone-bottom-right" onclick="rotateZone('bottom-right')" title="Rotate Bottom-Right 2x2">‚Üª</div>
        <div class="rotation-zone zone-center" onclick="rotateZone('center')" title="Rotate Center 2x2">‚Üª</div>
      </div>
    </div>
  </div>

  <div class="help-overlay" id="help-overlay" onclick="hideHelp()">
    <div class="help-content" onclick="event.stopPropagation()">
      <h2 style="color: #d4af37; margin-top: 0;">Complete Image</h2>
      <img id="help-image" class="help-image" src="" alt="Complete puzzle image">
      <br>
      <button class="close-help" onclick="hideHelp()">Close</button>
    </div>
  </div>

  <script>
    let puzzleState = [];
    let moveCount = 0;
    let startTime = null;
    let timerInterval = null;
    let isGameWon = false;
    let currentImage = 'games/images/zues_lovers.png';
    let availableImages = [];

    // Available images with their display names
    const imageInfo = {
      'games/images/zues_lovers.png': 'Zeus & Lovers',
      'games/images/thor.png': 'Thor',
      'games/images/loki.png': 'Loki'
    };

    // Define the 5 rotation zones (2x2 each)
    const rotationZones = {
      'top-left': [[0, 1], [4, 5]],
      'top-right': [[2, 3], [6, 7]],
      'bottom-left': [[8, 9], [12, 13]],
      'bottom-right': [[10, 11], [14, 15]],
      'center': [[5, 6], [9, 10]]
    };

    // Initialize the game
    document.addEventListener('DOMContentLoaded', function() {
      loadAvailableImages();
      initPuzzle();
    });

    // Load available images dynamically
    function loadAvailableImages() {
      availableImages = Object.keys(imageInfo);
      const selector = document.getElementById('image-selector');
      
      availableImages.forEach((imagePath, index) => {
        const option = document.createElement('div');
        option.className = 'image-option';
        if (index === 0) option.classList.add('selected');
        option.style.backgroundImage = `url('${imagePath}')`;
        option.title = imageInfo[imagePath];
        option.onclick = () => selectImage(imagePath, option);
        selector.appendChild(option);
      });
    }

    // Select an image for the puzzle
    function selectImage(imagePath, element) {
      currentImage = imagePath;
      document.querySelectorAll('.image-option').forEach(opt => opt.classList.remove('selected'));
      element.classList.add('selected');
      
      // Update help image
      document.getElementById('help-image').src = currentImage;
      
      // Start new game with selected image
      shufflePuzzle();
    }

    // Initialize the puzzle
    function initPuzzle() {
      puzzleState = Array.from({length: 16}, (_, i) => i);
      moveCount = 0;
      startTime = null;
      isGameWon = false;
      document.getElementById('move-count').textContent = '0';
      document.getElementById('timer').textContent = '00:00';
      document.getElementById('win-message').style.display = 'none';
      document.getElementById('help-image').src = currentImage;
      
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      renderPuzzle();
    }

    // Render the puzzle grid
    function renderPuzzle() {
      const grid = document.getElementById('puzzle-grid');
      grid.innerHTML = '';
      
      for (let i = 0; i < 16; i++) {
        const tile = document.createElement('div');
        tile.className = 'puzzle-tile';
        
        const tileNumber = puzzleState[i];
        const row = Math.floor(tileNumber / 4);
        const col = tileNumber % 4;
        const tileSize = window.innerWidth <= 768 ? 320 : (window.innerWidth <= 1200 ? 400 : 500);
        
        tile.style.backgroundImage = `url('${currentImage}')`;
        tile.style.backgroundSize = `${tileSize}px ${tileSize}px`;
        tile.style.backgroundPosition = `-${col * (tileSize/4)}px -${row * (tileSize/4)}px`;
        
        grid.appendChild(tile);
      }
    }

    // Rotate a 2x2 zone clockwise
    function rotateZone(zoneName) {
      if (isGameWon) return;
      
      // Start timer on first move
      if (!startTime) {
        startTime = Date.now();
        timerInterval = setInterval(updateTimer, 1000);
      }
      
      const zone = rotationZones[zoneName];
      const positions = zone.flat();
      
      // Get current values at these positions
      const values = positions.map(pos => puzzleState[pos]);
      
      // Rotate clockwise: [0,1,2,3] -> [2,0,3,1]
      const rotatedValues = [values[2], values[0], values[3], values[1]];
      
      // Apply rotated values back to positions
      positions.forEach((pos, index) => {
        puzzleState[pos] = rotatedValues[index];
      });
      
      moveCount++;
      document.getElementById('move-count').textContent = moveCount;
      
      // Visual feedback for rotation
      const zoneElement = document.querySelector(`.zone-${zoneName.replace('-', '-')}`);
      zoneElement.classList.add('rotating');
      setTimeout(() => {
        zoneElement.classList.remove('rotating');
      }, 300);
      
      renderPuzzle();
      
      // Check for win
      if (checkWin()) {
        isGameWon = true;
        clearInterval(timerInterval);
        document.getElementById('win-message').style.display = 'block';
      }
    }

    // Check if puzzle is solved
    function checkWin() {
      for (let i = 0; i < 16; i++) {
        if (puzzleState[i] !== i) return false;
      }
      return true;
    }

    // Update timer display
    function updateTimer() {
      if (!startTime) return;
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
      const seconds = (elapsed % 60).toString().padStart(2, '0');
      document.getElementById('timer').textContent = `${minutes}:${seconds}`;
    }

    // Shuffle the puzzle
    function shufflePuzzle() {
      initPuzzle();
      
      // Perform random rotations to shuffle
      const zones = Object.keys(rotationZones);
      for (let i = 0; i < 50; i++) {
        const randomZone = zones[Math.floor(Math.random() * zones.length)];
        const zone = rotationZones[randomZone];
        const positions = zone.flat();
        
        // Get current values at these positions
        const values = positions.map(pos => puzzleState[pos]);
        
        // Rotate clockwise: [0,1,2,3] -> [2,0,3,1]
        const rotatedValues = [values[2], values[0], values[3], values[1]];
        
        // Apply rotated values back to positions
        positions.forEach((pos, index) => {
          puzzleState[pos] = rotatedValues[index];
        });
      }
      
      renderPuzzle();
    }

    // Show help overlay with complete image
    function showHelp() {
      document.getElementById('help-overlay').style.display = 'flex';
    }

    // Hide help overlay
    function hideHelp() {
      document.getElementById('help-overlay').style.display = 'none';
    }

    // Handle window resize
    window.addEventListener('resize', renderPuzzle);
  </script>
</body>
</html> 