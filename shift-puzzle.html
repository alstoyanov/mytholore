<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mytholore - Shift Puzzle Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      display: flex;
      flex-direction: column;
    }

    .game-header {
      background: rgba(0, 0, 0, 0.8);
      padding: 1rem 0;
      border-bottom: 2px solid #d4af37;
    }

    .game-header img {
      width: 300px;
      height: 112px;
      display: block;
      margin: 0 auto;
    }

    .game-nav {
      text-align: center;
      margin-top: 1rem;
    }

    .game-nav a {
      color: #d4af37;
      text-decoration: none;
      margin: 0 1rem;
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }

    .game-nav a:hover {
      color: #fff;
    }

    .game-main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      gap: 3rem;
    }

    .game-controls-panel {
      display: flex;
      flex-direction: column;
      gap: 2rem;
      min-width: 300px;
    }

    .control-section {
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid #d4af37;
      border-radius: 15px;
      padding: 1.5rem;
    }

    .control-section h3 {
      color: #d4af37;
      margin-top: 0;
      margin-bottom: 1rem;
      text-align: center;
    }

    .image-selector {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .image-option {
      width: 80px;
      height: 80px;
      border: 2px solid #666;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .image-option:hover {
      border-color: #d4af37;
      transform: scale(1.05);
    }

    .image-option.selected {
      border-color: #d4af37;
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
    }

    .game-stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .stat {
      text-align: center;
    }

    .stat-label {
      color: #999;
      font-size: 0.9rem;
    }

    .stat-value {
      color: #d4af37;
      font-size: 1.5rem;
      font-weight: bold;
    }

    .game-button {
      background: #d4af37;
      color: #000;
      border: none;
      padding: 1rem 1.5rem;
      margin: 0.5rem 0;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-weight: bold;
      font-size: 1rem;
      transition: all 0.3s ease;
      width: 100%;
    }

    .game-button:hover {
      background: #b8941f;
      transform: translateY(-2px);
    }

    .help-button {
      background: #4a90e2;
    }

    .help-button:hover {
      background: #357abd;
    }

    .back-button {
      background: #666;
      color: white;
    }

    .back-button:hover {
      background: #555;
    }

    .puzzle-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    .puzzle-container {
      position: relative;
      display: inline-block;
    }

    .puzzle-with-controls {
      display: grid;
      grid-template-columns: 60px repeat(4, 125px) 60px;
      grid-template-rows: 60px repeat(4, 125px) 60px;
      gap: 0px;
      align-items: center;
      justify-items: center;
    }

    .puzzle-grid {
      grid-column: 2 / 6;
      grid-row: 2 / 6;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 2px;
      width: 500px;
      height: 500px;
      border: 3px solid #d4af37;
      border-radius: 15px;
      overflow: hidden;
      background: #000;
      box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
    }

    .puzzle-tile {
      background-size: 500px 500px;
      border: 1px solid #333;
      transition: all 0.2s ease;
    }

    .shift-button {
      background: #d4af37;
      color: #000;
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5rem;
      font-weight: bold;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .shift-button:hover {
      background: #b8941f;
      transform: scale(1.1);
    }

    .shift-button:active {
      transform: scale(0.95);
      background: #ff6b35;
    }

    /* Column controls */
    .col-up-0 { grid-column: 2; grid-row: 1; }
    .col-up-1 { grid-column: 3; grid-row: 1; }
    .col-up-2 { grid-column: 4; grid-row: 1; }
    .col-up-3 { grid-column: 5; grid-row: 1; }

    .col-down-0 { grid-column: 2; grid-row: 6; }
    .col-down-1 { grid-column: 3; grid-row: 6; }
    .col-down-2 { grid-column: 4; grid-row: 6; }
    .col-down-3 { grid-column: 5; grid-row: 6; }

    /* Row controls */
    .row-left-0 { grid-column: 1; grid-row: 2; }
    .row-left-1 { grid-column: 1; grid-row: 3; }
    .row-left-2 { grid-column: 1; grid-row: 4; }
    .row-left-3 { grid-column: 1; grid-row: 5; }

    .row-right-0 { grid-column: 6; grid-row: 2; }
    .row-right-1 { grid-column: 6; grid-row: 3; }
    .row-right-2 { grid-column: 6; grid-row: 4; }
    .row-right-3 { grid-column: 6; grid-row: 5; }

    .win-message {
      background: rgba(212, 175, 55, 0.95);
      color: #000;
      padding: 2rem;
      border-radius: 15px;
      margin: 1rem 0;
      font-weight: bold;
      font-size: 1.5rem;
      text-align: center;
      display: none;
      box-shadow: 0 0 30px rgba(212, 175, 55, 0.7);
    }

    .help-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .help-content {
      background: rgba(0, 0, 0, 0.9);
      border: 3px solid #d4af37;
      border-radius: 15px;
      padding: 2rem;
      text-align: center;
      max-width: 90%;
      max-height: 90%;
    }

    .help-image {
      max-width: 400px;
      max-height: 400px;
      border: 2px solid #d4af37;
      border-radius: 10px;
      margin-bottom: 1rem;
    }

    .close-help {
      background: #d4af37;
      color: #000;
      border: none;
      padding: 1rem 2rem;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-weight: bold;
      font-size: 1.1rem;
    }

    .instructions {
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid #4a90e2;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      color: #ccc;
      font-size: 0.9rem;
      line-height: 1.4;
    }

    .instructions h4 {
      color: #4a90e2;
      margin-top: 0;
      margin-bottom: 0.5rem;
    }

    @media (max-width: 1200px) {
      .game-main {
        flex-direction: column;
        gap: 2rem;
      }

      .game-controls-panel {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        min-width: auto;
      }

      .control-section {
        flex: 1;
        min-width: 250px;
      }

      .puzzle-with-controls {
        grid-template-columns: 60px repeat(4, 100px) 60px;
        grid-template-rows: 60px repeat(4, 100px) 60px;
      }

      .puzzle-grid {
        width: 400px;
        height: 400px;
      }

      .puzzle-tile {
        background-size: 400px 400px;
      }
    }

    @media (max-width: 768px) {
      .puzzle-with-controls {
        grid-template-columns: 50px repeat(4, 80px) 50px;
        grid-template-rows: 50px repeat(4, 80px) 50px;
      }

      .puzzle-grid {
        width: 320px;
        height: 320px;
      }

      .puzzle-tile {
        background-size: 320px 320px;
      }

      .shift-button {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }

      .game-controls-panel {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>
  <div class="game-header">
    <img src="images/mytholore_logo.svg" alt="Mytholore Logo">
    <div class="game-nav">
      <a href="games.html">← Back to Games</a>
      <a href="index.html">World Map</a>
      <a href="albums.html">Albums</a>
      <a href="about.html">About</a>
    </div>
  </div>

  <div class="game-main">
    <div class="game-controls-panel">
      <div class="control-section">
        <h3>Choose Image</h3>
        <div id="image-selector" class="image-selector">
          <!-- Images will be loaded dynamically -->
        </div>
      </div>

      <div class="control-section">
        <h3>Game Stats</h3>
        <div class="game-stats">
          <div class="stat">
            <div class="stat-label">Shifts</div>
            <div class="stat-value" id="move-count">0</div>
          </div>
          <div class="stat">
            <div class="stat-label">Time</div>
            <div class="stat-value" id="timer">00:00</div>
          </div>
        </div>
        
        <button class="game-button" onclick="shufflePuzzle()">New Game</button>
        <button class="game-button help-button" onclick="showHelp()">Show Complete Image</button>
        <button class="game-button back-button" onclick="window.location.href='games.html'">Back to Games</button>
      </div>

      <div class="control-section">
        <div class="instructions">
          <h4>How to Play:</h4>
          <p>• Use arrow buttons around the grid to shift rows and columns</p>
          <p>• ↑/↓ buttons shift columns up/down cyclically</p>
          <p>• ←/→ buttons shift rows left/right cyclically</p>
          <p>• Pieces wrap around to the opposite side</p>
          <p>• Reconstruct the complete image to win!</p>
        </div>
      </div>
    </div>

    <div class="puzzle-area">
      <div class="win-message" id="win-message">
        🎉 Congratulations! You solved the shift puzzle! 🎉
      </div>
      
      <div class="puzzle-container">
        <div class="puzzle-with-controls">
          <!-- Column up buttons -->
          <button class="shift-button col-up col-up-0" onclick="shiftColumn(0, 'up')" title="Shift Column 1 Up">↑</button>
          <button class="shift-button col-up col-up-1" onclick="shiftColumn(1, 'up')" title="Shift Column 2 Up">↑</button>
          <button class="shift-button col-up col-up-2" onclick="shiftColumn(2, 'up')" title="Shift Column 3 Up">↑</button>
          <button class="shift-button col-up col-up-3" onclick="shiftColumn(3, 'up')" title="Shift Column 4 Up">↑</button>

          <!-- Row left buttons -->
          <button class="shift-button row-left row-left-0" onclick="shiftRow(0, 'left')" title="Shift Row 1 Left">←</button>
          <button class="shift-button row-left row-left-1" onclick="shiftRow(1, 'left')" title="Shift Row 2 Left">←</button>
          <button class="shift-button row-left row-left-2" onclick="shiftRow(2, 'left')" title="Shift Row 3 Left">←</button>
          <button class="shift-button row-left row-left-3" onclick="shiftRow(3, 'left')" title="Shift Row 4 Left">←</button>

          <!-- Puzzle grid -->
          <div id="puzzle-grid" class="puzzle-grid"></div>

          <!-- Row right buttons -->
          <button class="shift-button row-right row-right-0" onclick="shiftRow(0, 'right')" title="Shift Row 1 Right">→</button>
          <button class="shift-button row-right row-right-1" onclick="shiftRow(1, 'right')" title="Shift Row 2 Right">→</button>
          <button class="shift-button row-right row-right-2" onclick="shiftRow(2, 'right')" title="Shift Row 3 Right">→</button>
          <button class="shift-button row-right row-right-3" onclick="shiftRow(3, 'right')" title="Shift Row 4 Right">→</button>

          <!-- Column down buttons -->
          <button class="shift-button col-down col-down-0" onclick="shiftColumn(0, 'down')" title="Shift Column 1 Down">↓</button>
          <button class="shift-button col-down col-down-1" onclick="shiftColumn(1, 'down')" title="Shift Column 2 Down">↓</button>
          <button class="shift-button col-down col-down-2" onclick="shiftColumn(2, 'down')" title="Shift Column 3 Down">↓</button>
          <button class="shift-button col-down col-down-3" onclick="shiftColumn(3, 'down')" title="Shift Column 4 Down">↓</button>
        </div>
      </div>
    </div>
  </div>

  <div class="help-overlay" id="help-overlay" onclick="hideHelp()">
    <div class="help-content" onclick="event.stopPropagation()">
      <h2 style="color: #d4af37; margin-top: 0;">Complete Image</h2>
      <img id="help-image" class="help-image" src="" alt="Complete puzzle image">
      <br>
      <button class="close-help" onclick="hideHelp()">Close</button>
    </div>
  </div>

  <script>
    let puzzleState = [];
    let moveCount = 0;
    let startTime = null;
    let timerInterval = null;
    let isGameWon = false;
    let currentImage = 'games/images/zues_lovers.png';
    let availableImages = [];

    // Available images with their display names
    const imageInfo = {
      'games/images/zues_lovers.png': 'Zeus & Lovers',
      'games/images/thor.png': 'Thor',
      'games/images/loki.png': 'Loki'
    };

    // Initialize the game
    document.addEventListener('DOMContentLoaded', function() {
      loadAvailableImages();
      initPuzzle();
    });

    // Load available images dynamically
    function loadAvailableImages() {
      availableImages = Object.keys(imageInfo);
      const selector = document.getElementById('image-selector');
      
      availableImages.forEach((imagePath, index) => {
        const option = document.createElement('div');
        option.className = 'image-option';
        if (index === 0) option.classList.add('selected');
        option.style.backgroundImage = `url('${imagePath}')`;
        option.title = imageInfo[imagePath];
        option.onclick = () => selectImage(imagePath, option);
        selector.appendChild(option);
      });
    }

    // Select an image for the puzzle
    function selectImage(imagePath, element) {
      currentImage = imagePath;
      document.querySelectorAll('.image-option').forEach(opt => opt.classList.remove('selected'));
      element.classList.add('selected');
      
      // Update help image
      document.getElementById('help-image').src = currentImage;
      
      // Start new game with selected image
      shufflePuzzle();
    }

    // Initialize the puzzle
    function initPuzzle() {
      puzzleState = Array.from({length: 16}, (_, i) => i);
      moveCount = 0;
      startTime = null;
      isGameWon = false;
      document.getElementById('move-count').textContent = '0';
      document.getElementById('timer').textContent = '00:00';
      document.getElementById('win-message').style.display = 'none';
      document.getElementById('help-image').src = currentImage;
      
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      renderPuzzle();
    }

    // Render the puzzle grid
    function renderPuzzle() {
      const grid = document.getElementById('puzzle-grid');
      grid.innerHTML = '';
      
      for (let i = 0; i < 16; i++) {
        const tile = document.createElement('div');
        tile.className = 'puzzle-tile';
        
        const tileNumber = puzzleState[i];
        const row = Math.floor(tileNumber / 4);
        const col = tileNumber % 4;
        const tileSize = window.innerWidth <= 768 ? 320 : (window.innerWidth <= 1200 ? 400 : 500);
        
        tile.style.backgroundImage = `url('${currentImage}')`;
        tile.style.backgroundSize = `${tileSize}px ${tileSize}px`;
        tile.style.backgroundPosition = `-${col * (tileSize/4)}px -${row * (tileSize/4)}px`;
        
        grid.appendChild(tile);
      }
    }

    // Shift a column up or down
    function shiftColumn(colIndex, direction) {
      if (isGameWon) return;
      
      // Start timer on first move
      if (!startTime) {
        startTime = Date.now();
        timerInterval = setInterval(updateTimer, 1000);
      }
      
      // Get column positions
      const columnPositions = [colIndex, colIndex + 4, colIndex + 8, colIndex + 12];
      const columnValues = columnPositions.map(pos => puzzleState[pos]);
      
      if (direction === 'up') {
        // Move up: [0,1,2,3] -> [1,2,3,0]
        const shiftedValues = [...columnValues.slice(1), columnValues[0]];
        columnPositions.forEach((pos, index) => {
          puzzleState[pos] = shiftedValues[index];
        });
      } else { // down
        // Move down: [0,1,2,3] -> [3,0,1,2]
        const shiftedValues = [columnValues[3], ...columnValues.slice(0, 3)];
        columnPositions.forEach((pos, index) => {
          puzzleState[pos] = shiftedValues[index];
        });
      }
      
      moveCount++;
      document.getElementById('move-count').textContent = moveCount;
      renderPuzzle();
      
      // Check for win
      if (checkWin()) {
        isGameWon = true;
        clearInterval(timerInterval);
        document.getElementById('win-message').style.display = 'block';
      }
    }

    // Shift a row left or right
    function shiftRow(rowIndex, direction) {
      if (isGameWon) return;
      
      // Start timer on first move
      if (!startTime) {
        startTime = Date.now();
        timerInterval = setInterval(updateTimer, 1000);
      }
      
      // Get row positions
      const rowStart = rowIndex * 4;
      const rowPositions = [rowStart, rowStart + 1, rowStart + 2, rowStart + 3];
      const rowValues = rowPositions.map(pos => puzzleState[pos]);
      
      if (direction === 'left') {
        // Move left: [0,1,2,3] -> [1,2,3,0]
        const shiftedValues = [...rowValues.slice(1), rowValues[0]];
        rowPositions.forEach((pos, index) => {
          puzzleState[pos] = shiftedValues[index];
        });
      } else { // right
        // Move right: [0,1,2,3] -> [3,0,1,2]
        const shiftedValues = [rowValues[3], ...rowValues.slice(0, 3)];
        rowPositions.forEach((pos, index) => {
          puzzleState[pos] = shiftedValues[index];
        });
      }
      
      moveCount++;
      document.getElementById('move-count').textContent = moveCount;
      renderPuzzle();
      
      // Check for win
      if (checkWin()) {
        isGameWon = true;
        clearInterval(timerInterval);
        document.getElementById('win-message').style.display = 'block';
      }
    }

    // Check if puzzle is solved
    function checkWin() {
      for (let i = 0; i < 16; i++) {
        if (puzzleState[i] !== i) return false;
      }
      return true;
    }

    // Update timer display
    function updateTimer() {
      if (!startTime) return;
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
      const seconds = (elapsed % 60).toString().padStart(2, '0');
      document.getElementById('timer').textContent = `${minutes}:${seconds}`;
    }

    // Shuffle the puzzle
    function shufflePuzzle() {
      initPuzzle();
      
      // Perform random shifts to shuffle
      for (let i = 0; i < 100; i++) {
        const isColumn = Math.random() < 0.5;
        
        if (isColumn) {
          const col = Math.floor(Math.random() * 4);
          const direction = Math.random() < 0.5 ? 'up' : 'down';
          
          const columnPositions = [col, col + 4, col + 8, col + 12];
          const columnValues = columnPositions.map(pos => puzzleState[pos]);
          
          if (direction === 'up') {
            const shiftedValues = [...columnValues.slice(1), columnValues[0]];
            columnPositions.forEach((pos, index) => {
              puzzleState[pos] = shiftedValues[index];
            });
          } else {
            const shiftedValues = [columnValues[3], ...columnValues.slice(0, 3)];
            columnPositions.forEach((pos, index) => {
              puzzleState[pos] = shiftedValues[index];
            });
          }
        } else {
          const row = Math.floor(Math.random() * 4);
          const direction = Math.random() < 0.5 ? 'left' : 'right';
          
          const rowStart = row * 4;
          const rowPositions = [rowStart, rowStart + 1, rowStart + 2, rowStart + 3];
          const rowValues = rowPositions.map(pos => puzzleState[pos]);
          
          if (direction === 'left') {
            const shiftedValues = [...rowValues.slice(1), rowValues[0]];
            rowPositions.forEach((pos, index) => {
              puzzleState[pos] = shiftedValues[index];
            });
          } else {
            const shiftedValues = [rowValues[3], ...rowValues.slice(0, 3)];
            rowPositions.forEach((pos, index) => {
              puzzleState[pos] = shiftedValues[index];
            });
          }
        }
      }
      
      renderPuzzle();
    }

    // Show help overlay with complete image
    function showHelp() {
      document.getElementById('help-overlay').style.display = 'flex';
    }

    // Hide help overlay
    function hideHelp() {
      document.getElementById('help-overlay').style.display = 'none';
    }

    // Handle window resize
    window.addEventListener('resize', renderPuzzle);
  </script>
</body>
</html> 