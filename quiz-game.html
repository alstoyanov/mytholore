<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mytholore - Mythology Quiz</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      display: flex;
      flex-direction: column;
    }

    .game-header {
      background: rgba(0, 0, 0, 0.8);
      padding: 1rem 0;
      border-bottom: 2px solid #d4af37;
    }

    .game-header img {
      width: 300px;
      height: 112px;
      display: block;
      margin: 0 auto;
    }

    .game-nav {
      text-align: center;
      margin-top: 1rem;
    }

    .game-nav a {
      color: #d4af37;
      text-decoration: none;
      margin: 0 1rem;
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }

    .game-nav a:hover {
      color: #fff;
    }

    .game-main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
    }

    .quiz-container {
      max-width: 800px;
      width: 100%;
      background: rgba(0, 0, 0, 0.8);
      border: 2px solid #d4af37;
      border-radius: 15px;
      padding: 2rem;
      text-align: center;
    }

    .quiz-setup {
      display: block;
    }

    .quiz-game {
      display: none;
    }

    .quiz-results {
      display: none;
    }

    h1 {
      color: #d4af37;
      margin-bottom: 2rem;
      font-size: 2.5rem;
    }

    h2 {
      color: #d4af37;
      margin-bottom: 1.5rem;
      font-size: 2rem;
    }

    .setup-section {
      margin-bottom: 2rem;
      text-align: left;
    }

    .setup-section h3 {
      color: #d4af37;
      margin-bottom: 1rem;
      font-size: 1.3rem;
    }

    .mythology-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .mythology-option {
      background: rgba(212, 175, 55, 0.1);
      border: 2px solid #666;
      border-radius: 10px;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }

    .mythology-option:hover {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.2);
    }

    .mythology-option.selected {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.3);
    }

    .mythology-option h4 {
      color: #d4af37;
      margin: 0 0 0.5rem 0;
      font-size: 1.1rem;
    }

    .mythology-option p {
      color: #ccc;
      margin: 0;
      font-size: 0.9rem;
    }

    .question-count-options {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .count-option {
      background: rgba(212, 175, 55, 0.1);
      border: 2px solid #666;
      border-radius: 50px;
      padding: 1rem 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #ccc;
      font-size: 1.2rem;
      font-weight: bold;
    }

    .count-option:hover {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.2);
      color: #d4af37;
    }

    .count-option.selected {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.3);
      color: #d4af37;
    }

    .start-button {
      background: #d4af37;
      color: #000;
      border: none;
      padding: 1rem 3rem;
      border-radius: 10px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-weight: bold;
      font-size: 1.2rem;
      transition: all 0.3s ease;
      margin-top: 1rem;
    }

    .start-button:hover {
      background: #b8941f;
      transform: translateY(-2px);
    }

    .start-button:disabled {
      background: #666;
      color: #999;
      cursor: not-allowed;
      transform: none;
    }

    .question-container {
      text-align: left;
      margin-bottom: 2rem;
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .question-number {
      color: #d4af37;
      font-size: 1.1rem;
      font-weight: bold;
    }

    .question-hint {
      color: #4a90e2;
      font-size: 0.9rem;
      font-style: italic;
    }

    .question-text {
      color: #fff;
      font-size: 1.3rem;
      margin-bottom: 1.5rem;
      line-height: 1.4;
    }

    .answer-options {
      display: grid;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .answer-option {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid #666;
      border-radius: 10px;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: left;
      color: #ccc;
      font-size: 1.1rem;
    }

    .answer-option:hover {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.1);
      color: #fff;
    }

    .answer-option.selected {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.2);
      color: #d4af37;
    }

    .answer-option.correct {
      border-color: #4caf50;
      background: rgba(76, 175, 80, 0.2);
      color: #4caf50;
    }

    .answer-option.incorrect {
      border-color: #f44336;
      background: rgba(244, 67, 54, 0.2);
      color: #f44336;
    }

    .explanation {
      background: rgba(212, 175, 55, 0.1);
      border: 1px solid #d4af37;
      border-radius: 10px;
      padding: 1rem;
      margin: 1rem 0;
      color: #ccc;
      display: none;
    }

    .explanation.show {
      display: block;
    }

    .quiz-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 2rem;
    }

    .quiz-button {
      background: #d4af37;
      color: #000;
      border: none;
      padding: 0.8rem 2rem;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      font-weight: bold;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .quiz-button:hover {
      background: #b8941f;
      transform: translateY(-2px);
    }

    .quiz-button:disabled {
      background: #666;
      color: #999;
      cursor: not-allowed;
      transform: none;
    }

    .back-button {
      background: #666;
      color: white;
    }

    .back-button:hover {
      background: #555;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #333;
      border-radius: 4px;
      margin-bottom: 2rem;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #d4af37, #b8941f);
      border-radius: 4px;
      transition: width 0.3s ease;
      width: 0%;
    }

    .results-summary {
      text-align: center;
      margin-bottom: 2rem;
    }

    .score-display {
      font-size: 3rem;
      color: #d4af37;
      font-weight: bold;
      margin-bottom: 1rem;
    }

    .score-message {
      font-size: 1.3rem;
      color: #ccc;
      margin-bottom: 2rem;
    }

    .results-details {
      text-align: left;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .result-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid #333;
    }

    .result-item:last-child {
      border-bottom: none;
    }

    .result-question {
      color: #ccc;
      flex: 1;
      margin-right: 1rem;
    }

    .result-status {
      font-weight: bold;
      padding: 0.3rem 0.8rem;
      border-radius: 15px;
      font-size: 0.9rem;
    }

    .result-correct {
      background: rgba(76, 175, 80, 0.2);
      color: #4caf50;
    }

    .result-incorrect {
      background: rgba(244, 67, 54, 0.2);
      color: #f44336;
    }

    @media (max-width: 768px) {
      .game-main {
        padding: 1rem;
      }

      .quiz-container {
        padding: 1rem;
      }

      h1 {
        font-size: 2rem;
      }

      .mythology-grid {
        grid-template-columns: 1fr;
      }

      .question-count-options {
        flex-direction: column;
        align-items: center;
      }

      .quiz-controls {
        flex-direction: column;
        gap: 1rem;
      }

      .score-display {
        font-size: 2rem;
      }
    }
  </style>
</head>

<body>
  <div class="game-header">
    <img src="images/mytholore_logo.svg" alt="Mytholore Logo">
    <div class="game-nav">
      <a href="games.html">‚Üê Back to Games</a>
      <a href="index.html">World Map</a>
      <a href="albums.html">Albums</a>
      <a href="about.html">About</a>
    </div>
  </div>

  <div class="game-main">
    <div class="quiz-container">
      <!-- Quiz Setup Screen -->
      <div id="quiz-setup" class="quiz-setup">
        <h1>Mythology Quiz</h1>
        
        <div class="setup-section">
          <h3>Choose Mythology</h3>
          <div id="mythology-grid" class="mythology-grid">
            <!-- Mythology options will be loaded here -->
          </div>
        </div>

        <div class="setup-section">
          <h3>Number of Questions</h3>
          <div class="question-count-options">
            <div class="count-option" data-count="3">3 Questions</div>
            <div class="count-option selected" data-count="5">5 Questions</div>
            <div class="count-option" data-count="10">10 Questions</div>
          </div>
        </div>

        <button id="start-quiz" class="start-button" disabled>Start Quiz</button>
      </div>

      <!-- Quiz Game Screen -->
      <div id="quiz-game" class="quiz-game">
        <div class="progress-bar">
          <div id="progress-fill" class="progress-fill"></div>
        </div>

        <div class="question-container">
          <div class="question-header">
            <span id="question-number" class="question-number">Question 1 of 5</span>
            <span id="question-hint" class="question-hint">Hint will appear here</span>
          </div>
          
          <div id="question-text" class="question-text">
            Question will appear here
          </div>

          <div id="answer-options" class="answer-options">
            <!-- Answer options will be loaded here -->
          </div>

          <div id="explanation" class="explanation">
            Explanation will appear here
          </div>
        </div>

        <div class="quiz-controls">
          <button id="back-to-setup" class="quiz-button back-button">Back to Setup</button>
          <button id="next-question" class="quiz-button" disabled>Next Question</button>
        </div>
      </div>

      <!-- Quiz Results Screen -->
      <div id="quiz-results" class="quiz-results">
        <h2>Quiz Complete!</h2>
        
        <div class="results-summary">
          <div id="score-display" class="score-display">0/5</div>
          <div id="score-message" class="score-message">Great job!</div>
        </div>

        <div id="results-details" class="results-details">
          <!-- Detailed results will appear here -->
        </div>

        <div class="quiz-controls">
          <button id="new-quiz" class="quiz-button">New Quiz</button>
          <button id="back-to-games" class="quiz-button back-button" onclick="window.location.href='games.html'">Back to Games</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let quizData = null;
    let selectedMythology = 'all';
    let selectedCount = 5;
    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let score = 0;

    // Embedded quiz data as fallback
    const embeddedQuizData = {
      "mythologies": {
        "egyptian": {
          "name": "Egyptian Mythology",
          "albums": {
            "divine_struggle": {
              "name": "The Divine Struggle",
              "questions": [
                {
                  "id": "eg_ds_1",
                  "question": "Which Egyptian god is celebrated in the song 'Golden Age' for bringing wisdom, balance, and divine rule to Egypt?",
                  "options": ["Ra", "Osiris", "Anubis", "Horus"],
                  "correct": 1,
                  "hint": "From 'The Divine Struggle' album - Golden Age",
                  "explanation": "Osiris reigned during Egypt's golden age, bringing wisdom, balance, and divine rule to the land."
                },
                {
                  "id": "eg_ds_2",
                  "question": "According to the lyrics of 'Golden Age', what flows freely during Osiris's prosperous reign?",
                  "options": ["The Nile", "Wine", "Gold", "Time"],
                  "correct": 0,
                  "hint": "From 'The Divine Struggle' album - Golden Age",
                  "explanation": "The song mentions 'Through golden fields where the river flows' and 'where the Nile flows freely'."
                },
                {
                  "id": "eg_ds_3",
                  "question": "In 'Golden Age', what whispers through the breeze during Osiris's peaceful reign?",
                  "options": ["Secrets", "Justice", "Love", "War"],
                  "correct": 1,
                  "hint": "From 'The Divine Struggle' album - Golden Age",
                  "explanation": "The lyrics state 'Justice whispers through the breeze, A world at peace, a land at ease.'"
                },
                {
                  "id": "eg_ds_4",
                  "question": "What does the song 'Golden Age' suggest is coming despite the current prosperity?",
                  "options": ["More prosperity", "A celebration", "A storm/darkness", "New temples"],
                  "correct": 2,
                  "hint": "From 'The Divine Struggle' album - Golden Age",
                  "explanation": "The song mentions 'But even in paradise, the winds of fate whisper of a coming storm' and 'Before the night begins to fall'."
                }
              ]
            }
          }
        },
        "indian": {
          "name": "Indian Mythology",
          "albums": {
            "mahabarata": {
              "name": "Mahabharata",
              "questions": [
                {
                  "id": "in_mb_1",
                  "question": "In 'The Curse of King Shantanu', who is the celestial river goddess that King Shantanu falls in love with?",
                  "options": ["Saraswati", "Ganga", "Yamuna", "Kaveri"],
                  "correct": 1,
                  "hint": "From 'Mahabharata' album - The Curse of King Shantanu",
                  "explanation": "Ganga, the celestial river goddess, marries King Shantanu under specific conditions."
                },
                {
                  "id": "in_mb_2",
                  "question": "What condition does Ganga set for marrying King Shantanu?",
                  "options": ["He must build her a temple", "He must never question her actions", "He must give up his kingdom", "He must worship only her"],
                  "correct": 1,
                  "hint": "From 'Mahabharata' album - The Curse of King Shantanu",
                  "explanation": "Ganga agrees to marry Shantanu only if he never questions her actions."
                },
                {
                  "id": "in_mb_3",
                  "question": "What tragic action does Ganga perform with their newborn sons?",
                  "options": ["Abandons them", "Drowns them in the river", "Gives them away", "Hides them"],
                  "correct": 1,
                  "hint": "From 'Mahabharata' album - The Curse of King Shantanu",
                  "explanation": "One by one, Ganga drowns their newborn sons in the river, which is part of their celestial curse."
                },
                {
                  "id": "in_mb_4",
                  "question": "What is the name of the eighth child who survives and later becomes a legendary warrior?",
                  "options": ["Arjuna", "Devavrata (Bhishma)", "Krishna", "Karna"],
                  "correct": 1,
                  "hint": "From 'Mahabharata' album - The Curse of King Shantanu",
                  "explanation": "Devavrata, later known as Bhishma, is the eighth child who survives and becomes one of the most legendary warriors."
                },
                {
                  "id": "in_mb_5",
                  "question": "Why did Ganga drown her own children according to the legend?",
                  "options": ["She was evil", "They were cursed celestial beings who needed to be freed", "She didn't want children", "It was a test"],
                  "correct": 1,
                  "hint": "From 'Mahabharata' album - The Curse of King Shantanu",
                  "explanation": "The children were celestial beings cursed to be born as mortals, and their fate was to be freed by their mother's hands."
                }
              ]
            }
          }
        },
        "greek": {
          "name": "Greek Mythology",
          "albums": {
            "hercules_labors": {
              "name": "Labors of the Titanborn",
              "questions": [
                {
                  "id": "gr_hl_1",
                  "question": "Which Greek hero is known for completing twelve legendary labors?",
                  "options": ["Perseus", "Theseus", "Hercules", "Achilles"],
                  "correct": 2,
                  "hint": "From 'Labors of the Titanborn' album",
                  "explanation": "Hercules (Heracles) is famous for completing the twelve labors as penance."
                },
                {
                  "id": "gr_hl_2",
                  "question": "What is the alternative name for Hercules in Greek mythology?",
                  "options": ["Heracles", "Herakles", "Both A and B", "Herakleitos"],
                  "correct": 2,
                  "hint": "From 'Labors of the Titanborn' album",
                  "explanation": "Hercules is the Roman name; the Greek names are Heracles or Herakles."
                }
              ]
            },
            "golden_fleece": {
              "name": "The Golden Fleece",
              "questions": [
                {
                  "id": "gr_gf_1",
                  "question": "Who led the Argonauts in their quest for the Golden Fleece?",
                  "options": ["Perseus", "Jason", "Theseus", "Odysseus"],
                  "correct": 1,
                  "hint": "From 'The Golden Fleece' album",
                  "explanation": "Jason led the Argonauts on their famous quest to retrieve the Golden Fleece."
                },
                {
                  "id": "gr_gf_2",
                  "question": "What was the name of Jason's ship?",
                  "options": ["Argo", "Odyssey", "Trireme", "Pentekonter"],
                  "correct": 0,
                  "hint": "From 'The Golden Fleece' album",
                  "explanation": "The Argo was the ship that carried Jason and the Argonauts on their quest."
                }
              ]
            },
            "olympians": {
              "name": "The Olympians",
              "questions": [
                {
                  "id": "gr_ol_1",
                  "question": "How many major Olympian gods are there in Greek mythology?",
                  "options": ["10", "12", "14", "16"],
                  "correct": 1,
                  "hint": "From 'The Olympians' album",
                  "explanation": "There are traditionally twelve major Olympian gods in Greek mythology."
                },
                {
                  "id": "gr_ol_2",
                  "question": "Who is the king of the Olympian gods?",
                  "options": ["Poseidon", "Hades", "Zeus", "Apollo"],
                  "correct": 2,
                  "hint": "From 'The Olympians' album",
                  "explanation": "Zeus is the king of the gods and ruler of Mount Olympus."
                }
              ]
            },
            "apple_of_ruin": {
              "name": "The Apple of Ruin",
              "questions": [
                {
                  "id": "gr_ar_1",
                  "question": "The Apple of Discord was thrown by which goddess?",
                  "options": ["Hera", "Athena", "Eris", "Aphrodite"],
                  "correct": 2,
                  "hint": "From 'The Apple of Ruin' album",
                  "explanation": "Eris, the goddess of discord, threw the golden apple that started the Trojan War."
                },
                {
                  "id": "gr_ar_2",
                  "question": "What was written on the Apple of Discord?",
                  "options": ["For the fairest", "For the strongest", "For the wisest", "For the bravest"],
                  "correct": 0,
                  "hint": "From 'The Apple of Ruin' album",
                  "explanation": "The apple was inscribed with 'For the fairest', causing a dispute among the goddesses."
                }
              ]
            }
          }
        },
        "norse": {
          "name": "Norse Mythology",
          "albums": {
            "odin": {
              "name": "Wonderer of the Nine Realms",
              "questions": [
                {
                  "id": "no_od_1",
                  "question": "How many realms exist in Norse cosmology?",
                  "options": ["Seven", "Nine", "Twelve", "Thirteen"],
                  "correct": 1,
                  "hint": "From 'Wonderer of the Nine Realms' album",
                  "explanation": "Norse mythology describes nine realms connected by Yggdrasil, the World Tree."
                },
                {
                  "id": "no_od_2",
                  "question": "What is Odin's role in Norse mythology?",
                  "options": ["God of Thunder", "All-Father and ruler of Asgard", "God of the Sea", "God of War only"],
                  "correct": 1,
                  "hint": "From 'Wonderer of the Nine Realms' album",
                  "explanation": "Odin is the All-Father, the chief god and ruler of Asgard in Norse mythology."
                },
                {
                  "id": "no_od_3",
                  "question": "What did Odin sacrifice to gain wisdom?",
                  "options": ["His throne", "His eye", "His hammer", "His horse"],
                  "correct": 1,
                  "hint": "From 'Wonderer of the Nine Realms' album",
                  "explanation": "Odin sacrificed his eye at Mimir's well to gain wisdom and knowledge."
                }
              ]
            }
          }
        },
        "mesopotamian": {
          "name": "Mesopotamian Mythology",
          "albums": {
            "gilgamesh": {
              "name": "Shadows of Immortality",
              "questions": [
                {
                  "id": "me_gi_1",
                  "question": "Gilgamesh was the king of which ancient city?",
                  "options": ["Babylon", "Uruk", "Ur", "Nineveh"],
                  "correct": 1,
                  "hint": "From 'Shadows of Immortality' album",
                  "explanation": "Gilgamesh was the legendary king of Uruk in ancient Mesopotamia."
                },
                {
                  "id": "me_gi_2",
                  "question": "Who was Gilgamesh's closest friend in the epic?",
                  "options": ["Enkidu", "Utnapishtim", "Shamhat", "Humbaba"],
                  "correct": 0,
                  "hint": "From 'Shadows of Immortality' album",
                  "explanation": "Enkidu was created by the gods and became Gilgamesh's closest friend and companion."
                }
              ]
            },
            "enuma_elish": {
              "name": "Enuma Elish",
              "questions": [
                {
                  "id": "me_ee_1",
                  "question": "Enuma Elish is the Mesopotamian creation myth. What does 'Enuma Elish' mean?",
                  "options": ["In the beginning", "When on high", "From the depths", "By the gods"],
                  "correct": 1,
                  "hint": "From 'Enuma Elish' album",
                  "explanation": "'Enuma Elish' means 'When on high' and are the opening words of the Babylonian creation epic."
                },
                {
                  "id": "me_ee_2",
                  "question": "Who is the hero god in Enuma Elish who defeats the primordial chaos?",
                  "options": ["Enlil", "Marduk", "Ea", "Anu"],
                  "correct": 1,
                  "hint": "From 'Enuma Elish' album",
                  "explanation": "Marduk defeats Tiamat (primordial chaos) and becomes king of the gods in the Enuma Elish."
                }
              ]
            }
          }
        },
        "celtic": {
          "name": "Celtic Mythology",
          "albums": {
            "dagda": {
              "name": "String of the Gods",
              "questions": [
                {
                  "id": "ce_da_1",
                  "question": "The Dagda is known as the 'Good God' in Celtic mythology. What is he particularly associated with?",
                  "options": ["War and battle", "Fertility, agriculture, and magic", "The sea and storms", "Death and the underworld"],
                  "correct": 1,
                  "hint": "From 'String of the Gods' album",
                  "explanation": "The Dagda is associated with fertility, agriculture, strength, and magic in Celtic mythology."
                },
                {
                  "id": "ce_da_2",
                  "question": "What magical instrument is the Dagda famous for possessing?",
                  "options": ["A sword", "A harp", "A cauldron", "Both B and C"],
                  "correct": 3,
                  "hint": "From 'String of the Gods' album",
                  "explanation": "The Dagda is famous for both his magical harp that could control emotions and seasons, and his cauldron of plenty."
                }
              ]
            }
          }
        },
        "roman": {
          "name": "Roman Mythology",
          "albums": {
            "romulus_and_remus": {
              "name": "Romulus and Remus",
              "questions": [
                {
                  "id": "ro_rr_1",
                  "question": "According to Roman legend, who raised Romulus and Remus?",
                  "options": ["A shepherd", "A wolf", "A king", "A priest"],
                  "correct": 1,
                  "hint": "From 'Romulus and Remus' album",
                  "explanation": "Romulus and Remus were raised by a she-wolf after being abandoned as infants."
                },
                {
                  "id": "ro_rr_2",
                  "question": "Which city did Romulus found after killing his brother Remus?",
                  "options": ["Naples", "Rome", "Florence", "Milan"],
                  "correct": 1,
                  "hint": "From 'Romulus and Remus' album",
                  "explanation": "Romulus founded Rome after killing his twin brother Remus in a dispute over the city's location."
                }
              ]
            }
          }
        },
        "persian": {
          "name": "Persian Mythology",
          "albums": {
            "rostam": {
              "name": "Rostam",
              "questions": [
                {
                  "id": "pe_ro_1",
                  "question": "Rostam is a legendary hero from which Persian epic?",
                  "options": ["Avesta", "Shahnameh", "Rubaiyat", "Masnavi"],
                  "correct": 1,
                  "hint": "From 'Rostam' album",
                  "explanation": "Rostam is the greatest hero in Ferdowsi's Shahnameh (Book of Kings), the Persian national epic."
                },
                {
                  "id": "pe_ro_2",
                  "question": "What is the name of Rostam's famous horse?",
                  "options": ["Rakhsh", "Shabdiz", "Duldul", "Buraq"],
                  "correct": 0,
                  "hint": "From 'Rostam' album",
                  "explanation": "Rakhsh is Rostam's legendary horse, known for its strength, speed, and loyalty."
                }
              ]
            }
          }
        },
        "african": {
          "name": "African Mythology",
          "albums": {
            "anansi": {
              "name": "Anansi",
              "questions": [
                {
                  "id": "af_an_1",
                  "question": "Anansi is a trickster figure in West African folklore. What animal is he typically depicted as?",
                  "options": ["A rabbit", "A spider", "A coyote", "A raven"],
                  "correct": 1,
                  "hint": "From 'Anansi' album",
                  "explanation": "Anansi is the spider trickster god in West African and Caribbean folklore."
                },
                {
                  "id": "af_an_2",
                  "question": "What is Anansi most famous for bringing to humanity?",
                  "options": ["Fire", "Stories and wisdom", "Agriculture", "Music"],
                  "correct": 1,
                  "hint": "From 'Anansi' album",
                  "explanation": "Anansi is credited with bringing stories, wisdom, and knowledge to humanity through his clever tricks."
                }
              ]
            }
          }
        }
      }
    };

    // Load quiz data from JSON file with fallback to embedded data
    async function loadQuizData() {
      try {
        // Try to load from external JSON file first
        const response = await fetch('quiz-questions.json');
        if (response.ok) {
          quizData = await response.json();
          console.log('Loaded quiz data from external JSON file');
        } else {
          throw new Error('Failed to fetch JSON file');
        }
      } catch (error) {
        console.log('Using embedded quiz data as fallback');
        // Use embedded data as fallback
        quizData = embeddedQuizData;
      }
      
      initializeSetup();
    }

    // Initialize the setup screen
    function initializeSetup() {
      const mythologyGrid = document.getElementById('mythology-grid');
      
      // Add "All Mythologies" option
      const allOption = document.createElement('div');
      allOption.className = 'mythology-option selected';
      allOption.dataset.mythology = 'all';
      allOption.innerHTML = `
        <h4>All Mythologies</h4>
        <p>Questions from all available mythologies</p>
      `;
      mythologyGrid.appendChild(allOption);

      // Add individual mythology options
      Object.entries(quizData.mythologies).forEach(([key, mythology]) => {
        const option = document.createElement('div');
        option.className = 'mythology-option';
        option.dataset.mythology = key;
        
        const albumCount = Object.keys(mythology.albums).length;
        const questionCount = Object.values(mythology.albums)
          .reduce((total, album) => total + album.questions.length, 0);
        
        option.innerHTML = `
          <h4>${mythology.name}</h4>
          <p>${albumCount} album(s), ${questionCount} questions</p>
        `;
        mythologyGrid.appendChild(option);
      });

      // Add event listeners
      setupEventListeners();
      updateStartButton();
    }

    // Setup event listeners
    function setupEventListeners() {
      // Mythology selection
      document.querySelectorAll('.mythology-option').forEach(option => {
        option.addEventListener('click', () => {
          document.querySelectorAll('.mythology-option').forEach(opt => opt.classList.remove('selected'));
          option.classList.add('selected');
          selectedMythology = option.dataset.mythology;
          updateStartButton();
        });
      });

      // Question count selection
      document.querySelectorAll('.count-option').forEach(option => {
        option.addEventListener('click', () => {
          document.querySelectorAll('.count-option').forEach(opt => opt.classList.remove('selected'));
          option.classList.add('selected');
          selectedCount = parseInt(option.dataset.count);
          updateStartButton();
        });
      });

      // Start quiz button
      document.getElementById('start-quiz').addEventListener('click', startQuiz);

      // Quiz navigation buttons
      document.getElementById('back-to-setup').addEventListener('click', backToSetup);
      document.getElementById('next-question').addEventListener('click', nextQuestion);
      document.getElementById('new-quiz').addEventListener('click', newQuiz);
    }

    // Update start button state
    function updateStartButton() {
      const startButton = document.getElementById('start-quiz');
      const availableQuestions = getAvailableQuestions();
      
      if (availableQuestions.length >= selectedCount) {
        startButton.disabled = false;
        startButton.textContent = 'Start Quiz';
      } else {
        startButton.disabled = true;
        startButton.textContent = `Not enough questions (${availableQuestions.length} available)`;
      }
    }

    // Get available questions based on selection
    function getAvailableQuestions() {
      let questions = [];
      
      if (selectedMythology === 'all') {
        Object.values(quizData.mythologies).forEach(mythology => {
          Object.values(mythology.albums).forEach(album => {
            questions.push(...album.questions);
          });
        });
      } else {
        const mythology = quizData.mythologies[selectedMythology];
        if (mythology) {
          Object.values(mythology.albums).forEach(album => {
            questions.push(...album.questions);
          });
        }
      }
      
      return questions;
    }

    // Start the quiz
    function startQuiz() {
      const availableQuestions = getAvailableQuestions();
      
      // Shuffle and select questions
      const shuffled = availableQuestions.sort(() => 0.5 - Math.random());
      currentQuestions = shuffled.slice(0, selectedCount);
      
      // Reset quiz state
      currentQuestionIndex = 0;
      userAnswers = [];
      score = 0;
      
      // Show quiz screen
      document.getElementById('quiz-setup').style.display = 'none';
      document.getElementById('quiz-game').style.display = 'block';
      
      // Load first question
      loadQuestion();
    }

    // Load current question
    function loadQuestion() {
      const question = currentQuestions[currentQuestionIndex];
      
      // Update progress
      const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
      document.getElementById('progress-fill').style.width = progress + '%';
      
      // Update question info
      document.getElementById('question-number').textContent = 
        `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
      document.getElementById('question-hint').textContent = question.hint;
      document.getElementById('question-text').textContent = question.question;
      
      // Load answer options
      const optionsContainer = document.getElementById('answer-options');
      optionsContainer.innerHTML = '';
      
      question.options.forEach((option, index) => {
        const optionElement = document.createElement('div');
        optionElement.className = 'answer-option';
        optionElement.dataset.index = index;
        optionElement.textContent = option;
        
        optionElement.addEventListener('click', () => selectAnswer(index));
        optionsContainer.appendChild(optionElement);
      });
      
      // Hide explanation and reset next button
      document.getElementById('explanation').classList.remove('show');
      document.getElementById('next-question').disabled = true;
      document.getElementById('next-question').textContent = 
        currentQuestionIndex === currentQuestions.length - 1 ? 'Finish Quiz' : 'Next Question';
    }

    // Select an answer
    function selectAnswer(selectedIndex) {
      const question = currentQuestions[currentQuestionIndex];
      const options = document.querySelectorAll('.answer-option');
      
      // Remove previous selections
      options.forEach(opt => {
        opt.classList.remove('selected', 'correct', 'incorrect');
      });
      
      // Mark selected answer
      options[selectedIndex].classList.add('selected');
      
      // Show correct/incorrect
      options.forEach((opt, index) => {
        if (index === question.correct) {
          opt.classList.add('correct');
        } else if (index === selectedIndex && index !== question.correct) {
          opt.classList.add('incorrect');
        }
      });
      
      // Store answer
      userAnswers[currentQuestionIndex] = {
        questionId: question.id,
        selected: selectedIndex,
        correct: question.correct,
        isCorrect: selectedIndex === question.correct
      };
      
      if (selectedIndex === question.correct) {
        score++;
      }
      
      // Show explanation
      const explanation = document.getElementById('explanation');
      explanation.textContent = question.explanation;
      explanation.classList.add('show');
      
      // Enable next button
      document.getElementById('next-question').disabled = false;
    }

    // Go to next question or finish quiz
    function nextQuestion() {
      if (currentQuestionIndex < currentQuestions.length - 1) {
        currentQuestionIndex++;
        loadQuestion();
      } else {
        showResults();
      }
    }

    // Show quiz results
    function showResults() {
      document.getElementById('quiz-game').style.display = 'none';
      document.getElementById('quiz-results').style.display = 'block';
      
      // Update score display
      document.getElementById('score-display').textContent = `${score}/${currentQuestions.length}`;
      
      // Update score message
      const percentage = (score / currentQuestions.length) * 100;
      let message = '';
      if (percentage >= 90) message = 'Outstanding! You\'re a mythology master!';
      else if (percentage >= 80) message = 'Excellent! You know your myths well!';
      else if (percentage >= 70) message = 'Great job! Good knowledge of mythology!';
      else if (percentage >= 60) message = 'Not bad! Keep learning about mythology!';
      else message = 'Keep studying! There\'s so much to discover!';
      
      document.getElementById('score-message').textContent = message;
      
      // Show detailed results
      const detailsContainer = document.getElementById('results-details');
      detailsContainer.innerHTML = '';
      
      currentQuestions.forEach((question, index) => {
        const answer = userAnswers[index];
        const resultItem = document.createElement('div');
        resultItem.className = 'result-item';
        
        resultItem.innerHTML = `
          <div class="result-question">${question.question}</div>
          <div class="result-status ${answer.isCorrect ? 'result-correct' : 'result-incorrect'}">
            ${answer.isCorrect ? 'Correct' : 'Incorrect'}
          </div>
        `;
        
        detailsContainer.appendChild(resultItem);
      });
    }

    // Back to setup
    function backToSetup() {
      document.getElementById('quiz-game').style.display = 'none';
      document.getElementById('quiz-setup').style.display = 'block';
    }

    // Start new quiz
    function newQuiz() {
      document.getElementById('quiz-results').style.display = 'none';
      document.getElementById('quiz-setup').style.display = 'block';
    }

    // Initialize the quiz when page loads
    document.addEventListener('DOMContentLoaded', loadQuizData);
  </script>
</body>
</html> 